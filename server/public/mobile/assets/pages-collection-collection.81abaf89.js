import{_ as t}from"./page-meta.c55b99ba.js";import{C as e,aG as s,o as i,b as a,w as o,e as n,n as l,k as h,E as c,g as d,h as u,l as r,t as m,F as p,f,p as v,aH as b,aI as w,d as g,a0 as y,G as k,z as x,r as C,a as _}from"./index.04b6eec4.js";import{_ as W}from"./news-card.fc87f577.js";import{_ as X}from"./plugin-vue_export-helper.21dcd24c.js";import{_ as B}from"./z-paging.e1925f45.js";import{e as $,c as j}from"./news.9ec33ace.js";import"./u-image.92ccec93.js";import"./u-icon.91768b19.js";import"./icon_visit.21b6ed3b.js";var F=X({name:"u-swipe-action",emits:["click","content-click","open","close"],props:{index:{type:[Number,String],default:""},btnWidth:{type:[String,Number],default:180},disabled:{type:Boolean,default:!1},show:{type:Boolean,default:!1},bgColor:{type:String,default:"#ffffff"},vibrateShort:{type:Boolean,default:!1},options:{type:Array,default:()=>[]}},watch:{show:{immediate:!0,handler(t,e){t?this.open():this.close()}}},data(){return{moveX:0,scrollX:0,status:!1,movableAreaWidth:0,elId:this.$u.guid(),showBtn:!1}},computed:{movableViewWidth(){return this.movableAreaWidth+this.allBtnWidth+"px"},innerBtnWidth(){return e(this.btnWidth)},allBtnWidth(){return e(this.btnWidth)*this.options.length},btnStyle(){return t=>(t.width=this.btnWidth+"rpx",t)}},mounted(){this.getActionRect()},methods:{btnClick(t){this.status=!1,this.$emit("click",this.index,t)},change(t){this.scrollX=t.detail.x},close(){this.moveX=0,this.status=!1},open(){this.disabled||(this.moveX=-this.allBtnWidth,this.status=!0)},touchend(){this.moveX=this.scrollX,this.$nextTick((function(){0==this.status?this.scrollX<=-this.allBtnWidth/4?(this.moveX=-this.allBtnWidth,this.status=!0,this.emitOpenEvent(),this.vibrateShort&&s()):(this.moveX=0,this.status=!1,this.emitCloseEvent()):this.scrollX>3*-this.allBtnWidth/4?(this.moveX=0,this.$nextTick((()=>{this.moveX=101})),this.status=!1,this.emitCloseEvent()):(this.moveX=-this.allBtnWidth,this.status=!0,this.emitOpenEvent())}))},emitOpenEvent(){this.$emit("open",this.index)},emitCloseEvent(){this.$emit("close",this.index)},touchstart(){},getActionRect(){this.$uGetRect(".u-swipe-action").then((t=>{this.movableAreaWidth=t.width,this.$nextTick((()=>{this.showBtn=!0}))}))},contentClick(){1==this.status&&(this.status="close",this.moveX=0),this.$emit("content-click",this.index)}}},[["render",function(t,e,s,g,y,k){const x=v,C=b,_=w;return i(),a(x,{class:""},{default:o((()=>[n(_,{class:"u-swipe-action",style:l({backgroundColor:s.bgColor})},{default:o((()=>[n(C,{class:"u-swipe-view",onChange:k.change,onTouchend:k.touchend,onTouchstart:k.touchstart,direction:"horizontal",disabled:s.disabled,x:y.moveX,style:l({width:k.movableViewWidth?k.movableViewWidth:"100%"})},{default:o((()=>[n(x,{class:"u-swipe-content",onClick:h(k.contentClick,["stop"])},{default:o((()=>[c(t.$slots,"default",{},void 0,!0)])),_:3},8,["onClick"]),y.showBtn?(i(!0),d(p,{key:0},u(s.options,((t,e)=>(i(),a(x,{class:"u-swipe-del",onClick:h((t=>k.btnClick(e)),["stop"]),style:l([k.btnStyle(t.style)]),key:e},{default:o((()=>[n(x,{class:"u-btn-text"},{default:o((()=>[r(m(t.text),1)])),_:2},1024)])),_:2},1032,["onClick","style"])))),128)):f("v-if",!0)])),_:3},8,["onChange","onTouchend","onTouchstart","disabled","x","style"])])),_:3},8,["style"])])),_:3})}],["__scopeId","data-v-d0fdd334"]]);const E=g({__name:"collection",setup(e){const s=y(),l=k([{text:"取消收藏",style:{color:"#FFFFFF",backgroundColor:"#FF2C3C"}}]),h=x([]),c=async(t,e)=>{const{lists:i}=await $();i.forEach((t=>{t.show=!1})),h.value=i,s.value.complete(i)},r=async t=>{try{const e=h.value[t].article_id;await j({id:e}),uni.$u.toast("已取消收藏"),s.value.reload()}catch(e){console.log("取消收藏报错=>",e)}};return(e,m)=>{const f=C(_("page-meta"),t),v=C(_("news-card"),W),b=C(_("u-swipe-action"),F),w=C(_("z-paging"),B);return i(),d(p,null,[n(f,{"page-style":e.$theme.pageStyle},null,8,["page-style"]),n(w,{ref_key:"paging",ref:s,modelValue:h.value,"onUpdate:modelValue":m[0]||(m[0]=t=>h.value=t),onQuery:c,fixed:!1,height:"100%","use-page-scroll":""},{default:o((()=>[(i(!0),d(p,null,u(h.value,((t,e)=>(i(),a(b,{show:t.show,index:e,key:t.id,onClick:r,options:l,"btn-width":"120"},{default:o((()=>[n(v,{item:t,newsId:t.article_id},null,8,["item","newsId"])])),_:2},1032,["show","index","options"])))),128))])),_:1},8,["modelValue"])],64)}}});export{E as default};
